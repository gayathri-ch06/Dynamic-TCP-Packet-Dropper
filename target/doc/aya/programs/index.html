<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="eBPF program types."><title>aya::programs - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../static.files/rustdoc-42caa33d.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="aya" data-themes="" data-resource-suffix="" data-rustdoc-version="1.85.0-nightly (a47555110 2024-11-22)" data-channel="nightly" data-search-js="search-92e6798f.js" data-settings-js="settings-0f613d39.js" ><script src="../../static.files/storage-59e33391.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../static.files/main-5f194d8c.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-893ab5e7.css"></noscript><link rel="icon" href="https://aya-rs.dev/assets/images/crabby.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button><a class="logo-container" href="../../aya/index.html"><img src="https://aya-rs.dev/assets/images/crabby.svg" alt=""></a></nav><nav class="sidebar"><div class="sidebar-crate"><a class="logo-container" href="../../aya/index.html"><img src="https://aya-rs.dev/assets/images/crabby.svg" alt="logo"></a><h2><a href="../../aya/index.html">aya</a><span class="version">0.12.0</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module programs</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#loading-and-attaching-programs" title="Loading and attaching programs">Loading and attaching programs</a></li></ul><h3><a href="#reexports">Module Items</a></h3><ul class="block"><li><a href="#reexports" title="Re-exports">Re-exports</a></li><li><a href="#modules" title="Modules">Modules</a></li><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#enums" title="Enums">Enums</a></li><li><a href="#functions" title="Functions">Functions</a></li></ul></section><div id="rustdoc-modnav"><h2 class="in-crate"><a href="../index.html">In crate aya</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><span class="rustdoc-breadcrumbs"><a href="../index.html">aya</a></span><h1>Module <span>programs</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../src/aya/programs/mod.rs.html#1-988">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>eBPF program types.</p>
<p>eBPF programs are loaded inside the kernel and attached to one or more hook
points. Whenever the hook points are reached, the programs are executed.</p>
<h2 id="loading-and-attaching-programs"><a class="doc-anchor" href="#loading-and-attaching-programs">§</a>Loading and attaching programs</h2>
<p>When you call <a href="../struct.Ebpf.html#method.load_file" title="associated function aya::Ebpf::load_file"><code>Ebpf::load_file</code></a> or <a href="../struct.Ebpf.html#method.load" title="associated function aya::Ebpf::load"><code>Ebpf::load</code></a>, all the programs included
in the object code are parsed and relocated. Programs are not loaded
automatically though, since often you will need to do some application
specific setup before you can actually load them.</p>
<p>In order to load and attach a program, you need to retrieve it using <a href="../struct.Ebpf.html#method.program_mut" title="method aya::Ebpf::program_mut"><code>Ebpf::program_mut</code></a>,
then call the <code>load()</code> and <code>attach()</code> methods, for example:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>aya::{Ebpf, programs::KProbe};

<span class="kw">let </span><span class="kw-2">mut </span>bpf = Ebpf::load_file(<span class="string">"ebpf_programs.o"</span>)<span class="question-mark">?</span>;
<span class="comment">// intercept_wakeups is the name of the program we want to load
</span><span class="kw">let </span>program: <span class="kw-2">&amp;mut </span>KProbe = bpf.program_mut(<span class="string">"intercept_wakeups"</span>).unwrap().try_into()<span class="question-mark">?</span>;
program.load()<span class="question-mark">?</span>;
<span class="comment">// intercept_wakeups will be called every time try_to_wake_up() is called
// inside the kernel
</span>program.attach(<span class="string">"try_to_wake_up"</span>, <span class="number">0</span>)<span class="question-mark">?</span>;</code></pre></div>
<p>The signature of the <code>attach()</code> method varies depending on what kind of
program you’re trying to attach.</p>
</div></details><h2 id="reexports" class="section-header">Re-exports<a href="#reexports" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name" id="reexport.CgroupDevice"><code>pub use crate::programs::cgroup_device::<a class="struct" href="cgroup_device/struct.CgroupDevice.html" title="struct aya::programs::cgroup_device::CgroupDevice">CgroupDevice</a>;</code></div></li><li><div class="item-name" id="reexport.CgroupSkb"><code>pub use crate::programs::cgroup_skb::<a class="struct" href="cgroup_skb/struct.CgroupSkb.html" title="struct aya::programs::cgroup_skb::CgroupSkb">CgroupSkb</a>;</code></div></li><li><div class="item-name" id="reexport.CgroupSkbAttachType"><code>pub use crate::programs::cgroup_skb::<a class="enum" href="cgroup_skb/enum.CgroupSkbAttachType.html" title="enum aya::programs::cgroup_skb::CgroupSkbAttachType">CgroupSkbAttachType</a>;</code></div></li><li><div class="item-name" id="reexport.CgroupSock"><code>pub use crate::programs::cgroup_sock::<a class="struct" href="cgroup_sock/struct.CgroupSock.html" title="struct aya::programs::cgroup_sock::CgroupSock">CgroupSock</a>;</code></div></li><li><div class="item-name" id="reexport.CgroupSockAddr"><code>pub use crate::programs::cgroup_sock_addr::<a class="struct" href="cgroup_sock_addr/struct.CgroupSockAddr.html" title="struct aya::programs::cgroup_sock_addr::CgroupSockAddr">CgroupSockAddr</a>;</code></div></li><li><div class="item-name" id="reexport.CgroupSockopt"><code>pub use crate::programs::cgroup_sockopt::<a class="struct" href="cgroup_sockopt/struct.CgroupSockopt.html" title="struct aya::programs::cgroup_sockopt::CgroupSockopt">CgroupSockopt</a>;</code></div></li><li><div class="item-name" id="reexport.CgroupSysctl"><code>pub use crate::programs::cgroup_sysctl::<a class="struct" href="cgroup_sysctl/struct.CgroupSysctl.html" title="struct aya::programs::cgroup_sysctl::CgroupSysctl">CgroupSysctl</a>;</code></div></li><li><div class="item-name" id="reexport.Extension"><code>pub use crate::programs::extension::<a class="struct" href="extension/struct.Extension.html" title="struct aya::programs::extension::Extension">Extension</a>;</code></div></li><li><div class="item-name" id="reexport.ExtensionError"><code>pub use crate::programs::extension::<a class="enum" href="extension/enum.ExtensionError.html" title="enum aya::programs::extension::ExtensionError">ExtensionError</a>;</code></div></li><li><div class="item-name" id="reexport.FEntry"><code>pub use crate::programs::fentry::<a class="struct" href="fentry/struct.FEntry.html" title="struct aya::programs::fentry::FEntry">FEntry</a>;</code></div></li><li><div class="item-name" id="reexport.FExit"><code>pub use crate::programs::fexit::<a class="struct" href="fexit/struct.FExit.html" title="struct aya::programs::fexit::FExit">FExit</a>;</code></div></li><li><div class="item-name" id="reexport.KProbe"><code>pub use crate::programs::kprobe::<a class="struct" href="kprobe/struct.KProbe.html" title="struct aya::programs::kprobe::KProbe">KProbe</a>;</code></div></li><li><div class="item-name" id="reexport.KProbeError"><code>pub use crate::programs::kprobe::<a class="enum" href="kprobe/enum.KProbeError.html" title="enum aya::programs::kprobe::KProbeError">KProbeError</a>;</code></div></li><li><div class="item-name" id="reexport.CgroupAttachMode"><code>pub use crate::programs::links::<a class="enum" href="links/enum.CgroupAttachMode.html" title="enum aya::programs::links::CgroupAttachMode">CgroupAttachMode</a>;</code></div></li><li><div class="item-name" id="reexport.Link"><code>pub use crate::programs::links::<a class="trait" href="links/trait.Link.html" title="trait aya::programs::links::Link">Link</a>;</code></div></li><li><div class="item-name" id="reexport.LircMode2"><code>pub use crate::programs::lirc_mode2::<a class="struct" href="lirc_mode2/struct.LircMode2.html" title="struct aya::programs::lirc_mode2::LircMode2">LircMode2</a>;</code></div></li><li><div class="item-name" id="reexport.Lsm"><code>pub use crate::programs::lsm::<a class="struct" href="lsm/struct.Lsm.html" title="struct aya::programs::lsm::Lsm">Lsm</a>;</code></div></li><li><div class="item-name" id="reexport.PerfEvent"><code>pub use crate::programs::perf_event::<a class="struct" href="perf_event/struct.PerfEvent.html" title="struct aya::programs::perf_event::PerfEvent">PerfEvent</a>;</code></div></li><li><div class="item-name" id="reexport.PerfEventScope"><code>pub use crate::programs::perf_event::<a class="enum" href="perf_event/enum.PerfEventScope.html" title="enum aya::programs::perf_event::PerfEventScope">PerfEventScope</a>;</code></div></li><li><div class="item-name" id="reexport.PerfTypeId"><code>pub use crate::programs::perf_event::<a class="enum" href="perf_event/enum.PerfTypeId.html" title="enum aya::programs::perf_event::PerfTypeId">PerfTypeId</a>;</code></div></li><li><div class="item-name" id="reexport.SamplePolicy"><code>pub use crate::programs::perf_event::<a class="enum" href="perf_event/enum.SamplePolicy.html" title="enum aya::programs::perf_event::SamplePolicy">SamplePolicy</a>;</code></div></li><li><div class="item-name" id="reexport.RawTracePoint"><code>pub use crate::programs::raw_trace_point::<a class="struct" href="raw_trace_point/struct.RawTracePoint.html" title="struct aya::programs::raw_trace_point::RawTracePoint">RawTracePoint</a>;</code></div></li><li><div class="item-name" id="reexport.SkLookup"><code>pub use crate::programs::sk_lookup::<a class="struct" href="sk_lookup/struct.SkLookup.html" title="struct aya::programs::sk_lookup::SkLookup">SkLookup</a>;</code></div></li><li><div class="item-name" id="reexport.SkMsg"><code>pub use crate::programs::sk_msg::<a class="struct" href="sk_msg/struct.SkMsg.html" title="struct aya::programs::sk_msg::SkMsg">SkMsg</a>;</code></div></li><li><div class="item-name" id="reexport.SkSkb"><code>pub use crate::programs::sk_skb::<a class="struct" href="sk_skb/struct.SkSkb.html" title="struct aya::programs::sk_skb::SkSkb">SkSkb</a>;</code></div></li><li><div class="item-name" id="reexport.SkSkbKind"><code>pub use crate::programs::sk_skb::<a class="enum" href="sk_skb/enum.SkSkbKind.html" title="enum aya::programs::sk_skb::SkSkbKind">SkSkbKind</a>;</code></div></li><li><div class="item-name" id="reexport.SockOps"><code>pub use crate::programs::sock_ops::<a class="struct" href="sock_ops/struct.SockOps.html" title="struct aya::programs::sock_ops::SockOps">SockOps</a>;</code></div></li><li><div class="item-name" id="reexport.SocketFilter"><code>pub use crate::programs::socket_filter::<a class="struct" href="socket_filter/struct.SocketFilter.html" title="struct aya::programs::socket_filter::SocketFilter">SocketFilter</a>;</code></div></li><li><div class="item-name" id="reexport.SocketFilterError"><code>pub use crate::programs::socket_filter::<a class="enum" href="socket_filter/enum.SocketFilterError.html" title="enum aya::programs::socket_filter::SocketFilterError">SocketFilterError</a>;</code></div></li><li><div class="item-name" id="reexport.SchedClassifier"><code>pub use crate::programs::tc::<a class="struct" href="tc/struct.SchedClassifier.html" title="struct aya::programs::tc::SchedClassifier">SchedClassifier</a>;</code></div></li><li><div class="item-name" id="reexport.TcAttachType"><code>pub use crate::programs::tc::<a class="enum" href="tc/enum.TcAttachType.html" title="enum aya::programs::tc::TcAttachType">TcAttachType</a>;</code></div></li><li><div class="item-name" id="reexport.TcError"><code>pub use crate::programs::tc::<a class="enum" href="tc/enum.TcError.html" title="enum aya::programs::tc::TcError">TcError</a>;</code></div></li><li><div class="item-name" id="reexport.BtfTracePoint"><code>pub use crate::programs::tp_btf::<a class="struct" href="tp_btf/struct.BtfTracePoint.html" title="struct aya::programs::tp_btf::BtfTracePoint">BtfTracePoint</a>;</code></div></li><li><div class="item-name" id="reexport.TracePoint"><code>pub use crate::programs::trace_point::<a class="struct" href="trace_point/struct.TracePoint.html" title="struct aya::programs::trace_point::TracePoint">TracePoint</a>;</code></div></li><li><div class="item-name" id="reexport.TracePointError"><code>pub use crate::programs::trace_point::<a class="enum" href="trace_point/enum.TracePointError.html" title="enum aya::programs::trace_point::TracePointError">TracePointError</a>;</code></div></li><li><div class="item-name" id="reexport.UProbe"><code>pub use crate::programs::uprobe::<a class="struct" href="uprobe/struct.UProbe.html" title="struct aya::programs::uprobe::UProbe">UProbe</a>;</code></div></li><li><div class="item-name" id="reexport.UProbeError"><code>pub use crate::programs::uprobe::<a class="enum" href="uprobe/enum.UProbeError.html" title="enum aya::programs::uprobe::UProbeError">UProbeError</a>;</code></div></li><li><div class="item-name" id="reexport.Xdp"><code>pub use crate::programs::xdp::<a class="struct" href="xdp/struct.Xdp.html" title="struct aya::programs::xdp::Xdp">Xdp</a>;</code></div></li><li><div class="item-name" id="reexport.XdpError"><code>pub use crate::programs::xdp::<a class="enum" href="xdp/enum.XdpError.html" title="enum aya::programs::xdp::XdpError">XdpError</a>;</code></div></li><li><div class="item-name" id="reexport.XdpFlags"><code>pub use crate::programs::xdp::<a class="struct" href="xdp/struct.XdpFlags.html" title="struct aya::programs::xdp::XdpFlags">XdpFlags</a>;</code></div></li></ul><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="cgroup_device/index.html" title="mod aya::programs::cgroup_device">cgroup_<wbr>device</a></div><div class="desc docblock-short">Cgroup device programs.</div></li><li><div class="item-name"><a class="mod" href="cgroup_skb/index.html" title="mod aya::programs::cgroup_skb">cgroup_<wbr>skb</a></div><div class="desc docblock-short">Cgroup skb programs.</div></li><li><div class="item-name"><a class="mod" href="cgroup_sock/index.html" title="mod aya::programs::cgroup_sock">cgroup_<wbr>sock</a></div><div class="desc docblock-short">Cgroup socket programs.</div></li><li><div class="item-name"><a class="mod" href="cgroup_sock_addr/index.html" title="mod aya::programs::cgroup_sock_addr">cgroup_<wbr>sock_<wbr>addr</a></div><div class="desc docblock-short">Cgroup socket address programs.</div></li><li><div class="item-name"><a class="mod" href="cgroup_sockopt/index.html" title="mod aya::programs::cgroup_sockopt">cgroup_<wbr>sockopt</a></div><div class="desc docblock-short">Cgroup socket option programs.</div></li><li><div class="item-name"><a class="mod" href="cgroup_sysctl/index.html" title="mod aya::programs::cgroup_sysctl">cgroup_<wbr>sysctl</a></div><div class="desc docblock-short">Cgroup sysctl programs.</div></li><li><div class="item-name"><a class="mod" href="extension/index.html" title="mod aya::programs::extension">extension</a></div><div class="desc docblock-short">Extension programs.</div></li><li><div class="item-name"><a class="mod" href="fentry/index.html" title="mod aya::programs::fentry">fentry</a></div><div class="desc docblock-short">Fentry programs.</div></li><li><div class="item-name"><a class="mod" href="fexit/index.html" title="mod aya::programs::fexit">fexit</a></div><div class="desc docblock-short">Fexit programs.</div></li><li><div class="item-name"><a class="mod" href="kprobe/index.html" title="mod aya::programs::kprobe">kprobe</a></div><div class="desc docblock-short">Kernel space probes.</div></li><li><div class="item-name"><a class="mod" href="links/index.html" title="mod aya::programs::links">links</a></div><div class="desc docblock-short">Program links.</div></li><li><div class="item-name"><a class="mod" href="lirc_mode2/index.html" title="mod aya::programs::lirc_mode2">lirc_<wbr>mode2</a></div><div class="desc docblock-short">Lirc programs.</div></li><li><div class="item-name"><a class="mod" href="lsm/index.html" title="mod aya::programs::lsm">lsm</a></div><div class="desc docblock-short">LSM probes.</div></li><li><div class="item-name"><a class="mod" href="perf_attach/index.html" title="mod aya::programs::perf_attach">perf_<wbr>attach</a></div><div class="desc docblock-short">Perf attach links.</div></li><li><div class="item-name"><a class="mod" href="perf_event/index.html" title="mod aya::programs::perf_event">perf_<wbr>event</a></div><div class="desc docblock-short">Perf event programs.</div></li><li><div class="item-name"><a class="mod" href="raw_trace_point/index.html" title="mod aya::programs::raw_trace_point">raw_<wbr>trace_<wbr>point</a></div><div class="desc docblock-short">Raw tracepoints.</div></li><li><div class="item-name"><a class="mod" href="sk_lookup/index.html" title="mod aya::programs::sk_lookup">sk_<wbr>lookup</a></div><div class="desc docblock-short">Programmable socket lookup.</div></li><li><div class="item-name"><a class="mod" href="sk_msg/index.html" title="mod aya::programs::sk_msg">sk_msg</a></div><div class="desc docblock-short">Skmsg programs.</div></li><li><div class="item-name"><a class="mod" href="sk_skb/index.html" title="mod aya::programs::sk_skb">sk_skb</a></div><div class="desc docblock-short">Skskb programs.</div></li><li><div class="item-name"><a class="mod" href="sock_ops/index.html" title="mod aya::programs::sock_ops">sock_<wbr>ops</a></div><div class="desc docblock-short">Socket option programs.</div></li><li><div class="item-name"><a class="mod" href="socket_filter/index.html" title="mod aya::programs::socket_filter">socket_<wbr>filter</a></div><div class="desc docblock-short">Socket filter programs.</div></li><li><div class="item-name"><a class="mod" href="tc/index.html" title="mod aya::programs::tc">tc</a></div><div class="desc docblock-short">Network traffic control programs.</div></li><li><div class="item-name"><a class="mod" href="tp_btf/index.html" title="mod aya::programs::tp_btf">tp_btf</a></div><div class="desc docblock-short">BTF-enabled raw tracepoints.</div></li><li><div class="item-name"><a class="mod" href="trace_point/index.html" title="mod aya::programs::trace_point">trace_<wbr>point</a></div><div class="desc docblock-short">Tracepoint programs.</div></li><li><div class="item-name"><a class="mod" href="uprobe/index.html" title="mod aya::programs::uprobe">uprobe</a></div><div class="desc docblock-short">User space probes.</div></li><li><div class="item-name"><a class="mod" href="xdp/index.html" title="mod aya::programs::xdp">xdp</a></div><div class="desc docblock-short">eXpress Data Path (XDP) programs.</div></li></ul><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.ProgramFd.html" title="struct aya::programs::ProgramFd">Program<wbr>Fd</a></div><div class="desc docblock-short">A <a href="enum.Program.html" title="enum aya::programs::Program"><code>Program</code></a> file descriptor.</div></li><li><div class="item-name"><a class="struct" href="struct.ProgramInfo.html" title="struct aya::programs::ProgramInfo">Program<wbr>Info</a></div><div class="desc docblock-short">Provides metadata information about a loaded eBPF program.</div></li></ul><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.CgroupSockAddrAttachType.html" title="enum aya::programs::CgroupSockAddrAttachType">Cgroup<wbr>Sock<wbr>Addr<wbr>Attach<wbr>Type</a></div><div class="desc docblock-short">Defines where to attach a <code>CgroupSockAddr</code> program.</div></li><li><div class="item-name"><a class="enum" href="enum.CgroupSockAttachType.html" title="enum aya::programs::CgroupSockAttachType">Cgroup<wbr>Sock<wbr>Attach<wbr>Type</a></div><div class="desc docblock-short">Defines where to attach a <code>CgroupSock</code> program.</div></li><li><div class="item-name"><a class="enum" href="enum.CgroupSockoptAttachType.html" title="enum aya::programs::CgroupSockoptAttachType">Cgroup<wbr>Sockopt<wbr>Attach<wbr>Type</a></div><div class="desc docblock-short">Defines where to attach a <code>CgroupSockopt</code> program.</div></li><li><div class="item-name"><a class="enum" href="enum.ProbeKind.html" title="enum aya::programs::ProbeKind">Probe<wbr>Kind</a></div><div class="desc docblock-short">Kind of probe program</div></li><li><div class="item-name"><a class="enum" href="enum.Program.html" title="enum aya::programs::Program">Program</a></div><div class="desc docblock-short">The various eBPF programs.</div></li><li><div class="item-name"><a class="enum" href="enum.ProgramError.html" title="enum aya::programs::ProgramError">Program<wbr>Error</a></div><div class="desc docblock-short">Error type returned when working with programs.</div></li><li><div class="item-name"><a class="enum" href="enum.ProgramType.html" title="enum aya::programs::ProgramType">Program<wbr>Type</a></div><div class="desc docblock-short">The type of eBPF program.</div></li></ul><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.loaded_programs.html" title="fn aya::programs::loaded_programs">loaded_<wbr>programs</a></div><div class="desc docblock-short">Returns an iterator of <a href="struct.ProgramInfo.html" title="struct aya::programs::ProgramInfo"><code>ProgramInfo</code></a> over all eBPF programs loaded on the host.</div></li></ul></section></div></main></body></html>